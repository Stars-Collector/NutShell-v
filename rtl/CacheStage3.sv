// Generated by CIRCT firtool-1.62.0
// Standard header to adapt well known macros for register randomization.
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_MEM_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_MEM_INIT
`endif // not def RANDOMIZE
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_REG_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_REG_INIT
`endif // not def RANDOMIZE

// RANDOM may be set to an expression that produces a 32-bit random unsigned value.
`ifndef RANDOM
  `define RANDOM $random
`endif // not def RANDOM

// Users can define INIT_RANDOM as general code that gets injected into the
// initializer block for modules with registers.
`ifndef INIT_RANDOM
  `define INIT_RANDOM
`endif // not def INIT_RANDOM

// If using random initialization, you can also define RANDOMIZE_DELAY to
// customize the delay used, otherwise 0.002 is used.
`ifndef RANDOMIZE_DELAY
  `define RANDOMIZE_DELAY 0.002
`endif // not def RANDOMIZE_DELAY

// Define INIT_RANDOM_PROLOG_ for use in our modules below.
`ifndef INIT_RANDOM_PROLOG_
  `ifdef RANDOMIZE
    `ifdef VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM
    `else  // VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM #`RANDOMIZE_DELAY begin end
    `endif // VERILATOR
  `else  // RANDOMIZE
    `define INIT_RANDOM_PROLOG_
  `endif // RANDOMIZE
`endif // not def INIT_RANDOM_PROLOG_

// Include register initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_REG_
    `define ENABLE_INITIAL_REG_
  `endif // not def ENABLE_INITIAL_REG_
`endif // not def SYNTHESIS

// Include rmemory initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_MEM_
    `define ENABLE_INITIAL_MEM_
  `endif // not def ENABLE_INITIAL_MEM_
`endif // not def SYNTHESIS

// Standard header to adapt well known macros for prints and assertions.

// Users can define 'PRINTF_COND' to add an extra gate to prints.
`ifndef PRINTF_COND_
  `ifdef PRINTF_COND
    `define PRINTF_COND_ (`PRINTF_COND)
  `else  // PRINTF_COND
    `define PRINTF_COND_ 1
  `endif // PRINTF_COND
`endif // not def PRINTF_COND_

// Users can define 'ASSERT_VERBOSE_COND' to add an extra gate to assert error printing.
`ifndef ASSERT_VERBOSE_COND_
  `ifdef ASSERT_VERBOSE_COND
    `define ASSERT_VERBOSE_COND_ (`ASSERT_VERBOSE_COND)
  `else  // ASSERT_VERBOSE_COND
    `define ASSERT_VERBOSE_COND_ 1
  `endif // ASSERT_VERBOSE_COND
`endif // not def ASSERT_VERBOSE_COND_

// Users can define 'STOP_COND' to add an extra gate to stop conditions.
`ifndef STOP_COND_
  `ifdef STOP_COND
    `define STOP_COND_ (`STOP_COND)
  `else  // STOP_COND
    `define STOP_COND_ 1
  `endif // STOP_COND
`endif // not def STOP_COND_

module CacheStage3(	// src/main/scala/nutcore/mem/Cache.scala:235:14
  input         clock,	// src/main/scala/nutcore/mem/Cache.scala:235:14
                reset,	// src/main/scala/nutcore/mem/Cache.scala:235:14
  output        io_in_ready,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_in_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [31:0] io_in_bits_req_addr,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [2:0]  io_in_bits_req_size,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [3:0]  io_in_bits_req_cmd,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [7:0]  io_in_bits_req_wmask,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [63:0] io_in_bits_req_wdata,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [86:0] io_in_bits_req_user,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [18:0] io_in_bits_metas_0_tag,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_in_bits_metas_0_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_metas_0_dirty,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [18:0] io_in_bits_metas_1_tag,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_in_bits_metas_1_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_metas_1_dirty,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [18:0] io_in_bits_metas_2_tag,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_in_bits_metas_2_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_metas_2_dirty,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [18:0] io_in_bits_metas_3_tag,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_in_bits_metas_3_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_metas_3_dirty,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [63:0] io_in_bits_datas_0_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_datas_1_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_datas_2_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_datas_3_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_in_bits_hit,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [3:0]  io_in_bits_waymask,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_in_bits_mmio,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_in_bits_isForwardData,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [63:0] io_in_bits_forwardData_data_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [3:0]  io_in_bits_forwardData_waymask,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_out_ready,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_out_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [3:0]  io_out_bits_cmd,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [63:0] io_out_bits_rdata,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [86:0] io_out_bits_user,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_isFinish,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_flush,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_dataReadBus_req_ready,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_dataReadBus_req_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [9:0]  io_dataReadBus_req_bits_setIdx,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [63:0] io_dataReadBus_resp_data_0_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_dataReadBus_resp_data_1_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_dataReadBus_resp_data_2_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
                io_dataReadBus_resp_data_3_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_dataWriteBus_req_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [9:0]  io_dataWriteBus_req_bits_setIdx,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [63:0] io_dataWriteBus_req_bits_data_data,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [3:0]  io_dataWriteBus_req_bits_waymask,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_metaWriteBus_req_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [6:0]  io_metaWriteBus_req_bits_setIdx,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [18:0] io_metaWriteBus_req_bits_data_tag,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_metaWriteBus_req_bits_data_dirty,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [3:0]  io_metaWriteBus_req_bits_waymask,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_mem_req_ready,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_mem_req_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [31:0] io_mem_req_bits_addr,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [3:0]  io_mem_req_bits_cmd,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [63:0] io_mem_req_bits_wdata,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_mem_resp_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [3:0]  io_mem_resp_bits_cmd,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [63:0] io_mem_resp_bits_rdata,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_mmio_req_ready,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_mmio_req_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [31:0] io_mmio_req_bits_addr,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [2:0]  io_mmio_req_bits_size,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [3:0]  io_mmio_req_bits_cmd,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [7:0]  io_mmio_req_bits_wmask,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output [63:0] io_mmio_req_bits_wdata,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input         io_mmio_resp_valid,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  input  [63:0] io_mmio_resp_bits_rdata,	// src/main/scala/nutcore/mem/Cache.scala:252:14
  output        io_dataReadRespToL1	// src/main/scala/nutcore/mem/Cache.scala:252:14
);

  wire        io_out_valid_0;	// src/main/scala/nutcore/mem/Cache.scala:445:31
  wire        io_mem_req_valid_0;	// src/main/scala/nutcore/mem/Cache.scala:329:48
  wire [63:0] _LogPerfHelper_timer;	// difftest/src/main/scala/common/LogPerfControl.scala:60:79
  wire        _LogPerfHelper_logEnable;	// difftest/src/main/scala/common/LogPerfControl.scala:60:79
  wire        _dataWriteArb_io_out_valid;	// src/main/scala/nutcore/mem/Cache.scala:255:28
  wire [9:0]  _dataWriteArb_io_out_bits_setIdx;	// src/main/scala/nutcore/mem/Cache.scala:255:28
  wire [63:0] _dataWriteArb_io_out_bits_data_data;	// src/main/scala/nutcore/mem/Cache.scala:255:28
  wire [3:0]  _dataWriteArb_io_out_bits_waymask;	// src/main/scala/nutcore/mem/Cache.scala:255:28
  wire        _metaWriteArb_io_out_valid;	// src/main/scala/nutcore/mem/Cache.scala:254:28
  wire [6:0]  _metaWriteArb_io_out_bits_setIdx;	// src/main/scala/nutcore/mem/Cache.scala:254:28
  wire [18:0] _metaWriteArb_io_out_bits_data_tag;	// src/main/scala/nutcore/mem/Cache.scala:254:28
  wire        _metaWriteArb_io_out_bits_data_dirty;	// src/main/scala/nutcore/mem/Cache.scala:254:28
  wire [3:0]  _metaWriteArb_io_out_bits_waymask;	// src/main/scala/nutcore/mem/Cache.scala:254:28
  wire        mmio = io_in_valid & io_in_bits_mmio;	// src/main/scala/nutcore/mem/Cache.scala:259:26
  wire        hit = io_in_valid & io_in_bits_hit;	// src/main/scala/nutcore/mem/Cache.scala:260:25
  wire        miss = io_in_valid & ~io_in_bits_hit;	// src/main/scala/nutcore/mem/Cache.scala:261:{26,29}
  wire        hitReadBurst = hit & io_in_bits_req_cmd == 4'h2;	// src/main/scala/bus/simplebus/SimpleBus.scala:76:27, src/main/scala/nutcore/mem/Cache.scala:235:14, :260:25, :263:26
  wire [18:0] metaHitWriteBus_x8_tag =
    (io_in_bits_waymask[0] ? io_in_bits_metas_0_tag : 19'h0)
    | (io_in_bits_waymask[1] ? io_in_bits_metas_1_tag : 19'h0)
    | (io_in_bits_waymask[2] ? io_in_bits_metas_2_tag : 19'h0)
    | (io_in_bits_waymask[3] ? io_in_bits_metas_3_tag : 19'h0);	// src/main/scala/chisel3/util/Mux.scala:30:73, :32:36
  wire        useForwardData =
    io_in_bits_isForwardData & io_in_bits_waymask == io_in_bits_forwardData_waymask;	// src/main/scala/nutcore/mem/Cache.scala:273:{49,71}
  wire [63:0] _dataReadArray_T_10 =
    (io_in_bits_waymask[0] ? io_in_bits_datas_0_data : 64'h0)
    | (io_in_bits_waymask[1] ? io_in_bits_datas_1_data : 64'h0)
    | (io_in_bits_waymask[2] ? io_in_bits_datas_2_data : 64'h0)
    | (io_in_bits_waymask[3] ? io_in_bits_datas_3_data : 64'h0);	// src/main/scala/chisel3/util/Mux.scala:30:73, :32:36, src/main/scala/nutcore/mem/Cache.scala:276:21
  wire [63:0] dataRead =
    useForwardData ? io_in_bits_forwardData_data_data : _dataReadArray_T_10;	// src/main/scala/chisel3/util/Mux.scala:30:73, src/main/scala/nutcore/mem/Cache.scala:273:49, :275:21
  reg  [2:0]  writeL2BeatCnt_value;	// src/main/scala/chisel3/util/Counter.scala:61:40
  wire        _io_isFinish_T_10 = io_out_ready & io_out_valid_0;	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:445:31
  wire        _dataHitWriteBus_x3_T = io_in_bits_req_cmd == 4'h3;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :279:32
  wire        _dataHitWriteBus_x3_T_1 = io_in_bits_req_cmd == 4'h7;	// src/main/scala/bus/simplebus/SimpleBus.scala:78:27, src/main/scala/nutcore/mem/Cache.scala:235:14
  wire        hitWrite = hit & io_in_bits_req_cmd[0];	// src/main/scala/bus/simplebus/SimpleBus.scala:74:22, src/main/scala/nutcore/mem/Cache.scala:260:25, :283:22
  wire [9:0]  dataHitWriteBus_x3 =
    {io_in_bits_req_addr[12:6],
     _dataHitWriteBus_x3_T | _dataHitWriteBus_x3_T_1
       ? writeL2BeatCnt_value
       : io_in_bits_req_addr[5:3]};	// src/main/scala/bus/simplebus/SimpleBus.scala:78:27, src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:258:31, :279:32, :286:{35,51,88}
  wire        metaHitWriteBus_x5 =
    hitWrite
    & ~(io_in_bits_waymask[0] & io_in_bits_metas_0_dirty | io_in_bits_waymask[1]
        & io_in_bits_metas_1_dirty | io_in_bits_waymask[2] & io_in_bits_metas_2_dirty
        | io_in_bits_waymask[3] & io_in_bits_metas_3_dirty);	// src/main/scala/chisel3/util/Mux.scala:30:73, :32:36, src/main/scala/nutcore/mem/Cache.scala:283:22, :289:{22,25}
  reg  [3:0]  state;	// src/main/scala/nutcore/mem/Cache.scala:294:22
  reg         needFlush;	// src/main/scala/nutcore/mem/Cache.scala:295:26
  reg  [2:0]  readBeatCnt_value;	// src/main/scala/chisel3/util/Counter.scala:61:40
  reg  [2:0]  writeBeatCnt_value;	// src/main/scala/chisel3/util/Counter.scala:61:40
  reg  [1:0]  state2;	// src/main/scala/nutcore/mem/Cache.scala:304:23
  wire        _io_mem_req_valid_T_1 = state == 4'h3;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :306:39
  wire        _io_dataReadRespToL1_T_2 = state == 4'h8;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :306:66
  wire        _GEN = state2 == 2'h0;	// src/main/scala/nutcore/mem/Cache.scala:304:23, :306:92
  wire        io_dataReadBus_req_valid_0 =
    (_io_mem_req_valid_T_1 | _io_dataReadRespToL1_T_2) & _GEN;	// src/main/scala/nutcore/mem/Cache.scala:306:{39,57,66,81,92}
  reg  [63:0] dataWay_0_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
  reg  [63:0] dataWay_1_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
  reg  [63:0] dataWay_2_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
  reg  [63:0] dataWay_3_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
  wire [63:0] _dataHitWay_T_10 =
    (io_in_bits_waymask[0] ? dataWay_0_data : 64'h0)
    | (io_in_bits_waymask[1] ? dataWay_1_data : 64'h0)
    | (io_in_bits_waymask[2] ? dataWay_2_data : 64'h0)
    | (io_in_bits_waymask[3] ? dataWay_3_data : 64'h0);	// src/main/scala/chisel3/util/Mux.scala:30:73, :32:36, src/main/scala/nutcore/mem/Cache.scala:276:21, :308:26
  wire        _GEN_0 = io_mem_req_ready & io_mem_req_valid_0;	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:329:48
  wire        _io_mem_req_valid_T = state == 4'h1;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :322:23
  wire [2:0]  cmd = _io_mem_req_valid_T ? 3'h2 : {&writeBeatCnt_value, 2'h3};	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:322:{16,23}, :323:{8,29}
  wire [31:0] io_mem_req_bits_addr_0 =
    _io_mem_req_valid_T
      ? {io_in_bits_req_addr[31:3], 3'h0}
      : {metaHitWriteBus_x8_tag, io_in_bits_req_addr[12:6], 6'h0};	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/chisel3/util/Mux.scala:30:73, src/main/scala/nutcore/mem/Cache.scala:258:31, :318:{35,44}, :321:18, :322:23, :324:35
  wire [3:0]  io_mem_req_bits_cmd_0 = {1'h0, cmd};	// src/main/scala/bus/simplebus/SimpleBus.scala:65:14, src/main/scala/nutcore/mem/Cache.scala:261:29, :322:16
  wire        _io_dataReadRespToL1_T_3 = state2 == 2'h2;	// src/main/scala/bus/simplebus/SimpleBus.scala:76:27, src/main/scala/nutcore/mem/Cache.scala:304:23, :329:89
  assign io_mem_req_valid_0 =
    _io_mem_req_valid_T | _io_mem_req_valid_T_1 & _io_dataReadRespToL1_T_3;	// src/main/scala/nutcore/mem/Cache.scala:306:39, :322:23, :329:{48,78,89}
  wire        io_mmio_req_valid_0 = state == 4'h5;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :334:31
  reg         afterFirstRead;	// src/main/scala/nutcore/mem/Cache.scala:336:31
  reg         alreadyOutFire;	// src/main/scala/nutcore/mem/Cache.scala:337:33
  wire        _io_out_valid_T_8 = state == 4'h2;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :338:68
  reg  [63:0] inRdataRegDemand;	// src/main/scala/nutcore/mem/Cache.scala:339:35
  wire        io_cohResp_valid = _io_dataReadRespToL1_T_2 & _io_dataReadRespToL1_T_3;	// src/main/scala/nutcore/mem/Cache.scala:306:66, :329:89, :344:46
  reg  [2:0]  respToL1Last_c_value;	// src/main/scala/chisel3/util/Counter.scala:61:40
  wire        dataRefillWriteBus_x9 = _io_out_valid_T_8 & io_mem_resp_valid;	// src/main/scala/nutcore/mem/Cache.scala:338:68, :404:39
  wire        metaRefillWriteBus_req_valid =
    _io_out_valid_T_8 & io_mem_resp_valid & io_mem_resp_bits_cmd == 4'h6;	// src/main/scala/bus/simplebus/SimpleBus.scala:91:24, src/main/scala/nutcore/mem/Cache.scala:235:14, :338:68, :412:59
  wire [63:0] io_out_bits_rdata_0 = hit ? dataRead : inRdataRegDemand;	// src/main/scala/nutcore/mem/Cache.scala:260:25, :275:21, :339:35, :439:29
  wire [3:0]  io_out_bits_cmd_0 =
    {1'h0,
     io_in_bits_req_cmd[0] | io_in_bits_req_cmd[3]
       ? (io_in_bits_req_cmd[0] ? 3'h5 : 3'h0)
       : 3'h6};	// src/main/scala/bus/simplebus/SimpleBus.scala:73:33, :74:22, src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:261:29, :347:54, :440:{21,27,79}
  wire        _io_isFinish_T_9 = state == 4'h7;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :446:48
  assign io_out_valid_0 =
    io_in_valid
    & (hit
       | (io_in_bits_req_cmd[0] | mmio
            ? _io_isFinish_T_9
            : afterFirstRead & ~alreadyOutFire));	// src/main/scala/bus/simplebus/SimpleBus.scala:74:22, src/main/scala/nutcore/mem/Cache.scala:259:26, :260:25, :336:31, :337:33, :445:31, :446:48, :447:{28,45,60,107,110}
  wire        io_isFinish_0 =
    hit | io_in_bits_req_cmd[0]
      ? _io_isFinish_T_10
      : _io_isFinish_T_9 & (_io_isFinish_T_10 | alreadyOutFire);	// src/main/scala/bus/simplebus/SimpleBus.scala:74:22, src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:260:25, :337:33, :446:48, :455:{8,13,68,84}
  wire        io_in_ready_0 = io_out_ready & ~(|state) & ~hitReadBurst & ~miss;	// src/main/scala/nutcore/mem/Cache.scala:261:26, :263:26, :294:22, :297:28, :343:31, :458:{55,70,73}
  reg  [63:0] c;	// src/main/scala/utils/GTimer.scala:24:20
  `ifndef SYNTHESIS	// src/main/scala/nutcore/mem/Cache.scala:265:9
    always @(posedge clock) begin	// src/main/scala/nutcore/mem/Cache.scala:265:9
      automatic logic [255:0] _GEN_1;	// src/main/scala/nutcore/mem/Cache.scala:464:465
      automatic logic         _GEN_2 =
        (`PRINTF_COND_) & _LogPerfHelper_logEnable & ~reset;	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/nutcore/mem/Cache.scala:265:9, src/main/scala/utils/Debug.scala:49:26
      _GEN_1 =
        {io_in_bits_datas_3_data,
         io_in_bits_datas_2_data,
         io_in_bits_datas_1_data,
         io_in_bits_datas_0_data};	// src/main/scala/nutcore/mem/Cache.scala:464:465
      if (~reset & mmio & hit) begin	// src/main/scala/nutcore/mem/Cache.scala:259:26, :260:25, :265:9
        if (`ASSERT_VERBOSE_COND_)	// src/main/scala/nutcore/mem/Cache.scala:265:9
          $error("Assertion failed: MMIO request should not hit in cache\n    at Cache.scala:265 assert(!(mmio && hit), \"MMIO request should not hit in cache\")\n");	// src/main/scala/nutcore/mem/Cache.scala:265:9
        if (`STOP_COND_)	// src/main/scala/nutcore/mem/Cache.scala:265:9
          $fatal;	// src/main/scala/nutcore/mem/Cache.scala:265:9
      end
      if (~reset & metaHitWriteBus_x5 & metaRefillWriteBus_req_valid) begin	// src/main/scala/nutcore/mem/Cache.scala:265:9, :289:22, :412:59, :461:9
        if (`ASSERT_VERBOSE_COND_)	// src/main/scala/nutcore/mem/Cache.scala:461:9
          $error("Assertion failed\n    at Cache.scala:461 assert(!(metaHitWriteBus.req.valid && metaRefillWriteBus.req.valid))\n");	// src/main/scala/nutcore/mem/Cache.scala:461:9
        if (`STOP_COND_)	// src/main/scala/nutcore/mem/Cache.scala:461:9
          $fatal;	// src/main/scala/nutcore/mem/Cache.scala:461:9
      end
      if (~reset & hitWrite & dataRefillWriteBus_x9) begin	// src/main/scala/nutcore/mem/Cache.scala:265:9, :283:22, :404:39, :462:9
        if (`ASSERT_VERBOSE_COND_)	// src/main/scala/nutcore/mem/Cache.scala:462:9
          $error("Assertion failed\n    at Cache.scala:462 assert(!(dataHitWriteBus.req.valid && dataRefillWriteBus.req.valid))\n");	// src/main/scala/nutcore/mem/Cache.scala:462:9
        if (`STOP_COND_)	// src/main/scala/nutcore/mem/Cache.scala:462:9
          $fatal;	// src/main/scala/nutcore/mem/Cache.scala:462:9
      end
      if (_GEN_2) begin	// src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002,
                " metaread idx %x waymask %b metas %x%x:%x %x%x:%x %x%x:%x %x%x:%x %x\n",
                io_in_bits_req_addr[12:6], io_in_bits_waymask, io_in_bits_metas_0_valid,
                io_in_bits_metas_0_dirty, io_in_bits_metas_0_tag,
                io_in_bits_metas_1_valid, io_in_bits_metas_1_dirty,
                io_in_bits_metas_1_tag, io_in_bits_metas_2_valid,
                io_in_bits_metas_2_dirty, io_in_bits_metas_2_tag,
                io_in_bits_metas_3_valid, io_in_bits_metas_3_dirty,
                io_in_bits_metas_3_tag, _GEN_1);	// src/main/scala/nutcore/mem/Cache.scala:77:45, :464:465, src/main/scala/utils/Debug.scala:49:26, :50:15
      end
      if ((`PRINTF_COND_) & _metaWriteArb_io_out_valid & _LogPerfHelper_logEnable
          & ~reset) begin	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/nutcore/mem/Cache.scala:254:28, :265:9, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002, "%d: [icache S3]: metawrite idx %x wmask %b meta %x%x:%x\n",
                c, _metaWriteArb_io_out_bits_setIdx, _metaWriteArb_io_out_bits_waymask,
                1'h1, _metaWriteArb_io_out_bits_data_dirty,
                _metaWriteArb_io_out_bits_data_tag);	// src/main/scala/nutcore/mem/Cache.scala:235:14, :252:14, :254:28, :255:28, :284:29, :288:29, src/main/scala/utils/Debug.scala:49:26, :50:15, src/main/scala/utils/GTimer.scala:24:20
      end
      if (_GEN_2) begin	// src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002,
                " in.ready = %d, in.valid = %d, hit = %x, state = %d, addr = %x cmd:%d probe:%d isFinish:%d\n",
                io_in_ready_0, io_in_valid, hit, state, io_in_bits_req_addr,
                io_in_bits_req_cmd, 1'h0, io_isFinish_0);	// src/main/scala/nutcore/mem/Cache.scala:260:25, :261:29, :294:22, :455:8, :458:70, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002, " out.valid:%d rdata:%x cmd:%d user:%x id:%x \n",
                io_out_valid_0, io_out_bits_rdata_0, io_out_bits_cmd_0,
                io_in_bits_req_user, 1'h0);	// src/main/scala/nutcore/mem/Cache.scala:261:29, :439:29, :440:21, :445:31, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002, " DHW: (%d, %d), data:%x setIdx:%x MHW:(%d, %d)\n",
                hitWrite, 1'h1, dataRead, dataHitWriteBus_x3, metaHitWriteBus_x5, 1'h1);	// src/main/scala/nutcore/mem/Cache.scala:235:14, :252:14, :254:28, :255:28, :275:21, :283:22, :284:29, :286:35, :288:29, :289:22, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002, " DreadCache: %x \n", _GEN_1);	// src/main/scala/nutcore/mem/Cache.scala:464:465, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002,
                " useFD:%d isFD:%d FD:%x DreadArray:%x dataRead:%x inwaymask:%x FDwaymask:%x \n",
                useForwardData, io_in_bits_isForwardData,
                io_in_bits_forwardData_data_data, _dataReadArray_T_10, dataRead,
                io_in_bits_waymask, io_in_bits_forwardData_waymask);	// src/main/scala/chisel3/util/Mux.scala:30:73, src/main/scala/nutcore/mem/Cache.scala:273:49, :275:21, src/main/scala/utils/Debug.scala:49:26, :50:15
      end
      if ((`PRINTF_COND_) & _dataWriteArb_io_out_valid & _LogPerfHelper_logEnable
          & ~reset) begin	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/nutcore/mem/Cache.scala:255:28, :265:9, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002, "[WB] waymask: %b data:%x setIdx:%x\n",
                _dataWriteArb_io_out_bits_waymask, _dataWriteArb_io_out_bits_data_data,
                _dataWriteArb_io_out_bits_setIdx);	// src/main/scala/nutcore/mem/Cache.scala:255:28, src/main/scala/utils/Debug.scala:49:26, :50:15
      end
      if ((`PRINTF_COND_) & _io_mem_req_valid_T_1 & _GEN_0 & _LogPerfHelper_logEnable
          & ~reset) begin	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:265:9, :306:39, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002,
                "[COUTW] cnt %x addr %x data %x cmd %x size %x wmask %x tag %x idx %x waymask %b \n",
                writeBeatCnt_value, io_mem_req_bits_addr_0, _dataHitWay_T_10,
                io_mem_req_bits_cmd_0, 3'h3, 8'hFF, io_in_bits_req_addr[31:13],
                io_in_bits_req_addr[12:6], io_in_bits_waymask);	// src/main/scala/bus/simplebus/SimpleBus.scala:65:14, src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/chisel3/util/Mux.scala:30:73, src/main/scala/nutcore/mem/Cache.scala:77:45, :258:31, :323:8, :324:35, src/main/scala/utils/BitUtils.scala:27:45, src/main/scala/utils/Debug.scala:49:26, :50:15
      end
      if ((`PRINTF_COND_) & _io_mem_req_valid_T & _GEN_0 & _LogPerfHelper_logEnable
          & ~reset) begin	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:265:9, :322:23, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002, "[COUTR] addr %x tag %x idx %x waymask %b \n",
                io_mem_req_bits_addr_0, io_in_bits_req_addr[31:13],
                io_in_bits_req_addr[12:6], io_in_bits_waymask);	// src/main/scala/nutcore/mem/Cache.scala:77:45, :258:31, :324:35, src/main/scala/utils/Debug.scala:49:26, :50:15
      end
      if ((`PRINTF_COND_) & _io_out_valid_T_8 & io_mem_resp_valid
          & _LogPerfHelper_logEnable & ~reset) begin	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/nutcore/mem/Cache.scala:265:9, :338:68, src/main/scala/utils/Debug.scala:49:26, :50:15
        $fwrite(32'h80000002, "[%d] CacheStage3: ", _LogPerfHelper_timer);	// difftest/src/main/scala/common/LogPerfControl.scala:60:79, src/main/scala/utils/Debug.scala:49:26
        $fwrite(32'h80000002, "[COUTR] cnt %x data %x tag %x idx %x waymask %b \n",
                readBeatCnt_value, io_mem_resp_bits_rdata, io_in_bits_req_addr[31:13],
                io_in_bits_req_addr[12:6], io_in_bits_waymask);	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:77:45, :258:31, src/main/scala/utils/Debug.scala:49:26, :50:15
      end
    end // always @(posedge)
  `endif // not def SYNTHESIS
  always @(posedge clock) begin	// src/main/scala/nutcore/mem/Cache.scala:235:14
    if (reset) begin	// src/main/scala/nutcore/mem/Cache.scala:235:14
      writeL2BeatCnt_value <= 3'h0;	// src/main/scala/chisel3/util/Counter.scala:61:40
      state <= 4'h0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
      needFlush <= 1'h0;	// src/main/scala/nutcore/mem/Cache.scala:261:29, :295:26
      readBeatCnt_value <= 3'h0;	// src/main/scala/chisel3/util/Counter.scala:61:40
      writeBeatCnt_value <= 3'h0;	// src/main/scala/chisel3/util/Counter.scala:61:40
      state2 <= 2'h0;	// src/main/scala/nutcore/mem/Cache.scala:304:23
      afterFirstRead <= 1'h0;	// src/main/scala/nutcore/mem/Cache.scala:261:29, :336:31
      alreadyOutFire <= 1'h0;	// src/main/scala/nutcore/mem/Cache.scala:261:29, :337:33
      respToL1Last_c_value <= 3'h0;	// src/main/scala/chisel3/util/Counter.scala:61:40
      c <= 64'h0;	// src/main/scala/nutcore/mem/Cache.scala:276:21, src/main/scala/utils/GTimer.scala:24:20
    end
    else begin	// src/main/scala/nutcore/mem/Cache.scala:235:14
      automatic logic _respToL1Fire_T;	// src/main/scala/nutcore/mem/Cache.scala:350:35
      automatic logic _respToL1Last_T_6;	// src/main/scala/nutcore/mem/Cache.scala:351:112
      automatic logic _GEN_3;	// src/main/scala/nutcore/mem/Cache.scala:353:18
      automatic logic _GEN_4;	// src/main/scala/nutcore/mem/Cache.scala:353:18
      automatic logic _GEN_5;	// src/main/scala/nutcore/mem/Cache.scala:353:18
      automatic logic _GEN_6;	// src/main/scala/nutcore/mem/Cache.scala:353:18
      automatic logic _GEN_7;	// src/main/scala/nutcore/mem/Cache.scala:353:18
      automatic logic _GEN_8;	// src/main/scala/nutcore/mem/Cache.scala:336:31, :353:18, :385:31, :386:24
      automatic logic _GEN_9;	// src/main/scala/nutcore/mem/Cache.scala:336:31, :353:18
      automatic logic _GEN_10;	// src/main/scala/nutcore/mem/Cache.scala:353:18
      _respToL1Fire_T = hitReadBurst & io_out_ready;	// src/main/scala/nutcore/mem/Cache.scala:263:26, :350:35
      _respToL1Last_T_6 =
        (~(|state) | _io_dataReadRespToL1_T_2 & _io_dataReadRespToL1_T_3) & hitReadBurst
        & io_out_ready;	// src/main/scala/nutcore/mem/Cache.scala:263:26, :294:22, :297:28, :306:66, :329:89, :343:31, :351:{48,71,112}
      _GEN_3 = state == 4'h5;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :353:18
      _GEN_4 = state == 4'h6;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :353:18
      _GEN_5 = state == 4'h8;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :353:18
      _GEN_6 = state == 4'h1;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :353:18
      _GEN_7 = state == 4'h2;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :353:18
      _GEN_8 = _GEN_7 & io_mem_resp_valid;	// src/main/scala/nutcore/mem/Cache.scala:336:31, :353:18, :385:31, :386:24
      _GEN_9 = _GEN_3 | _GEN_4 | _GEN_5 | _GEN_6;	// src/main/scala/nutcore/mem/Cache.scala:336:31, :353:18
      _GEN_10 = state == 4'h3;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :353:18
      if (~(|state) | _GEN_9
          | ~(_GEN_7 & io_mem_resp_valid & _dataHitWriteBus_x3_T)) begin	// src/main/scala/nutcore/mem/Cache.scala:279:{32,83}, :294:22, :297:28, :336:31, :353:18, :385:31, :388:{52,75}
        if (_io_isFinish_T_10 & (_dataHitWriteBus_x3_T | _dataHitWriteBus_x3_T_1))	// src/main/scala/bus/simplebus/SimpleBus.scala:78:27, src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:279:{20,32,60}
          writeL2BeatCnt_value <= writeL2BeatCnt_value + 3'h1;	// src/main/scala/chisel3/util/Counter.scala:61:40, :77:24, src/main/scala/nutcore/mem/Cache.scala:322:23
      end
      else	// src/main/scala/nutcore/mem/Cache.scala:279:83, :353:18
        writeL2BeatCnt_value <= 3'h0;	// src/main/scala/chisel3/util/Counter.scala:61:40
      if (|state) begin	// src/main/scala/nutcore/mem/Cache.scala:294:22, :297:28
        automatic logic respToL1Fire;	// src/main/scala/nutcore/mem/Cache.scala:350:51
        respToL1Fire = _respToL1Fire_T & _io_dataReadRespToL1_T_3;	// src/main/scala/nutcore/mem/Cache.scala:329:89, :350:{35,51}
        if (_GEN_3) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
          if (io_mmio_req_ready & io_mmio_req_valid_0)	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:334:31
            state <= 4'h6;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        end
        else if (_GEN_4) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
          if (io_mmio_resp_valid)	// src/main/scala/nutcore/mem/Cache.scala:252:14
            state <= 4'h7;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        end
        else if (_GEN_5) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
          if (respToL1Fire & _respToL1Last_T_6 & (&respToL1Last_c_value))	// src/main/scala/chisel3/util/Counter.scala:61:40, :73:24, src/main/scala/nutcore/mem/Cache.scala:350:51, :351:112, :376:69
            state <= 4'h0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        end
        else if (_GEN_6) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
          if (_GEN_0)	// src/main/scala/chisel3/util/Decoupled.scala:51:35
            state <= 4'h2;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        end
        else if (_GEN_7) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
          if (io_mem_resp_valid & io_mem_resp_bits_cmd == 4'h6)	// src/main/scala/bus/simplebus/SimpleBus.scala:91:24, src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :385:31, :389:{44,52}
            state <= 4'h7;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        end
        else if (_GEN_10) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
          if ((&{cmd[2], cmd[0]}) & _GEN_0)	// src/main/scala/bus/simplebus/SimpleBus.scala:65:14, :78:27, src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:322:16, :395:43
            state <= 4'h4;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        end
        else if (state == 4'h4) begin	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :353:18
          if (io_mem_resp_valid)	// src/main/scala/nutcore/mem/Cache.scala:252:14
            state <= 4'h1;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        end
        else if (state == 4'h7 & (_io_isFinish_T_10 | needFlush | alreadyOutFire))	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22, :295:26, :337:33, :353:18, :399:{55,74,82}
          state <= 4'h0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        if (~(_GEN_3 | _GEN_4)) begin	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:353:18
          if (_GEN_5) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
            if (io_cohResp_valid | respToL1Fire)	// src/main/scala/nutcore/mem/Cache.scala:344:46, :350:51, :375:29
              readBeatCnt_value <= readBeatCnt_value + 3'h1;	// src/main/scala/chisel3/util/Counter.scala:61:40, :77:24, src/main/scala/nutcore/mem/Cache.scala:322:23
          end
          else if (_GEN_6) begin	// src/main/scala/nutcore/mem/Cache.scala:353:18
            if (_GEN_0)	// src/main/scala/chisel3/util/Decoupled.scala:51:35
              readBeatCnt_value <= io_in_bits_req_addr[5:3];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:258:31
          end
          else if (_GEN_8)	// src/main/scala/nutcore/mem/Cache.scala:336:31, :353:18, :385:31, :386:24
            readBeatCnt_value <= readBeatCnt_value + 3'h1;	// src/main/scala/chisel3/util/Counter.scala:61:40, :77:24, src/main/scala/nutcore/mem/Cache.scala:322:23
        end
      end
      else if (_respToL1Fire_T) begin	// src/main/scala/nutcore/mem/Cache.scala:350:35
        state <= 4'h8;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        readBeatCnt_value <=
          (&(io_in_bits_req_addr[5:3])) ? 3'h0 : io_in_bits_req_addr[5:3] + 3'h1;	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:258:31, :322:23, :365:{33,49,93}
      end
      else if ((miss | mmio) & ~io_flush)	// src/main/scala/nutcore/mem/Cache.scala:259:26, :261:26, :366:{26,35,38}
        state <= {1'h0, mmio, 2'h1};	// src/main/scala/nutcore/mem/Cache.scala:259:26, :261:29, :294:22, :308:60, :367:21
      needFlush <= ~(_io_isFinish_T_10 & needFlush) & (io_flush & (|state) | needFlush);	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:294:22, :295:26, :297:{18,28,41,53}, :298:{21,35,47}
      if (~(|state) | _GEN_3 | _GEN_4 | _GEN_5 | _GEN_6 | _GEN_7
          | ~(_GEN_10 & _GEN_0)) begin	// src/main/scala/chisel3/util/Counter.scala:61:40, :77:15, src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:294:22, :297:28, :353:18, :394:30
      end
      else	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:353:18
        writeBeatCnt_value <= writeBeatCnt_value + 3'h1;	// src/main/scala/chisel3/util/Counter.scala:61:40, :77:24, src/main/scala/nutcore/mem/Cache.scala:322:23
      if (_GEN) begin	// src/main/scala/nutcore/mem/Cache.scala:306:92
        if (io_dataReadBus_req_ready & io_dataReadBus_req_valid_0)	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:306:81
          state2 <= 2'h1;	// src/main/scala/nutcore/mem/Cache.scala:304:23, :308:60
      end
      else if (state2 == 2'h1)	// src/main/scala/nutcore/mem/Cache.scala:304:23, :308:60, :311:19
        state2 <= 2'h2;	// src/main/scala/bus/simplebus/SimpleBus.scala:76:27, src/main/scala/nutcore/mem/Cache.scala:304:23
      else if (state2 == 2'h2 & (_GEN_0 | io_cohResp_valid | hitReadBurst & io_out_ready))	// src/main/scala/bus/simplebus/SimpleBus.scala:76:27, src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:263:26, :304:23, :311:19, :314:{63,79,96,105}, :344:46
        state2 <= 2'h0;	// src/main/scala/nutcore/mem/Cache.scala:304:23
      afterFirstRead <= (|state) & (~_GEN_9 & _GEN_8 | afterFirstRead);	// src/main/scala/nutcore/mem/Cache.scala:294:22, :297:28, :336:31, :353:18, :355:22, :385:31, :386:24
      alreadyOutFire <= (|state) & (_io_isFinish_T_10 | alreadyOutFire);	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/nutcore/mem/Cache.scala:294:22, :297:28, :337:33, :353:18, :356:22
      if (_respToL1Last_T_6)	// src/main/scala/nutcore/mem/Cache.scala:351:112
        respToL1Last_c_value <= respToL1Last_c_value + 3'h1;	// src/main/scala/chisel3/util/Counter.scala:61:40, :77:24, src/main/scala/nutcore/mem/Cache.scala:322:23
      c <= c + 64'h1;	// src/main/scala/utils/GTimer.scala:24:20, :25:12
    end
    if (state2 == 2'h1) begin	// src/main/scala/nutcore/mem/Cache.scala:304:23, :308:60
      dataWay_0_data <= io_dataReadBus_resp_data_0_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
      dataWay_1_data <= io_dataReadBus_resp_data_1_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
      dataWay_2_data <= io_dataReadBus_resp_data_2_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
      dataWay_3_data <= io_dataReadBus_resp_data_3_data;	// src/main/scala/nutcore/mem/Cache.scala:308:26
    end
    if (mmio ? state == 4'h6 : ~afterFirstRead & io_mem_resp_valid & _io_out_valid_T_8)	// src/main/scala/nutcore/mem/Cache.scala:235:14, :259:26, :294:22, :336:31, :338:{22,58,68}, :340:{39,52}
      inRdataRegDemand <= mmio ? io_mmio_resp_bits_rdata : io_mem_resp_bits_rdata;	// src/main/scala/nutcore/mem/Cache.scala:259:26, :339:{35,39}
  end // always @(posedge)
  `ifdef ENABLE_INITIAL_REG_	// src/main/scala/nutcore/mem/Cache.scala:235:14
    `ifdef FIRRTL_BEFORE_INITIAL	// src/main/scala/nutcore/mem/Cache.scala:235:14
      `FIRRTL_BEFORE_INITIAL	// src/main/scala/nutcore/mem/Cache.scala:235:14
    `endif // FIRRTL_BEFORE_INITIAL
    initial begin	// src/main/scala/nutcore/mem/Cache.scala:235:14
      automatic logic [31:0] _RANDOM[0:12];	// src/main/scala/nutcore/mem/Cache.scala:235:14
      `ifdef INIT_RANDOM_PROLOG_	// src/main/scala/nutcore/mem/Cache.scala:235:14
        `INIT_RANDOM_PROLOG_	// src/main/scala/nutcore/mem/Cache.scala:235:14
      `endif // INIT_RANDOM_PROLOG_
      `ifdef RANDOMIZE_REG_INIT	// src/main/scala/nutcore/mem/Cache.scala:235:14
        for (logic [3:0] i = 4'h0; i < 4'hD; i += 4'h1) begin
          _RANDOM[i] = `RANDOM;	// src/main/scala/nutcore/mem/Cache.scala:235:14
        end	// src/main/scala/nutcore/mem/Cache.scala:235:14
        writeL2BeatCnt_value = _RANDOM[4'h0][2:0];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14
        state = _RANDOM[4'h0][6:3];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14, :294:22
        needFlush = _RANDOM[4'h0][7];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14, :295:26
        readBeatCnt_value = _RANDOM[4'h0][10:8];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14
        writeBeatCnt_value = _RANDOM[4'h0][13:11];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14
        state2 = _RANDOM[4'h0][15:14];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14, :304:23
        dataWay_0_data = {_RANDOM[4'h0][31:16], _RANDOM[4'h1], _RANDOM[4'h2][15:0]};	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14, :308:26
        dataWay_1_data = {_RANDOM[4'h2][31:16], _RANDOM[4'h3], _RANDOM[4'h4][15:0]};	// src/main/scala/nutcore/mem/Cache.scala:235:14, :308:26
        dataWay_2_data = {_RANDOM[4'h4][31:16], _RANDOM[4'h5], _RANDOM[4'h6][15:0]};	// src/main/scala/nutcore/mem/Cache.scala:235:14, :308:26
        dataWay_3_data = {_RANDOM[4'h6][31:16], _RANDOM[4'h7], _RANDOM[4'h8][15:0]};	// src/main/scala/nutcore/mem/Cache.scala:235:14, :308:26
        afterFirstRead = _RANDOM[4'h8][16];	// src/main/scala/nutcore/mem/Cache.scala:235:14, :308:26, :336:31
        alreadyOutFire = _RANDOM[4'h8][17];	// src/main/scala/nutcore/mem/Cache.scala:235:14, :308:26, :337:33
        inRdataRegDemand = {_RANDOM[4'h8][31:18], _RANDOM[4'h9], _RANDOM[4'hA][17:0]};	// src/main/scala/nutcore/mem/Cache.scala:235:14, :308:26, :339:35
        respToL1Last_c_value = _RANDOM[4'hA][23:21];	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14, :339:35
        c = {_RANDOM[4'hA][31:24], _RANDOM[4'hB], _RANDOM[4'hC][23:0]};	// src/main/scala/nutcore/mem/Cache.scala:235:14, :339:35, src/main/scala/utils/GTimer.scala:24:20
      `endif // RANDOMIZE_REG_INIT
    end // initial
    `ifdef FIRRTL_AFTER_INITIAL	// src/main/scala/nutcore/mem/Cache.scala:235:14
      `FIRRTL_AFTER_INITIAL	// src/main/scala/nutcore/mem/Cache.scala:235:14
    `endif // FIRRTL_AFTER_INITIAL
  `endif // ENABLE_INITIAL_REG_
  Arbiter2_SRAMBundleAW metaWriteArb (	// src/main/scala/nutcore/mem/Cache.scala:254:28
    .io_in_0_valid           (metaHitWriteBus_x5),	// src/main/scala/nutcore/mem/Cache.scala:289:22
    .io_in_0_bits_setIdx     (io_in_bits_req_addr[12:6]),	// src/main/scala/nutcore/mem/Cache.scala:77:45
    .io_in_0_bits_data_tag   (metaHitWriteBus_x8_tag),	// src/main/scala/chisel3/util/Mux.scala:30:73
    .io_in_0_bits_data_dirty (1'h0),	// src/main/scala/nutcore/mem/Cache.scala:261:29
    .io_in_0_bits_waymask    (io_in_bits_waymask),
    .io_in_1_valid           (metaRefillWriteBus_req_valid),	// src/main/scala/nutcore/mem/Cache.scala:412:59
    .io_in_1_bits_setIdx     (io_in_bits_req_addr[12:6]),	// src/main/scala/nutcore/mem/Cache.scala:77:45
    .io_in_1_bits_data_tag   (io_in_bits_req_addr[31:13]),	// src/main/scala/nutcore/mem/Cache.scala:258:31
    .io_in_1_bits_data_dirty (1'h0),	// src/main/scala/nutcore/mem/Cache.scala:261:29
    .io_in_1_bits_waymask    (io_in_bits_waymask),
    .io_out_valid            (_metaWriteArb_io_out_valid),
    .io_out_bits_setIdx      (_metaWriteArb_io_out_bits_setIdx),
    .io_out_bits_data_tag    (_metaWriteArb_io_out_bits_data_tag),
    .io_out_bits_data_dirty  (_metaWriteArb_io_out_bits_data_dirty),
    .io_out_bits_waymask     (_metaWriteArb_io_out_bits_waymask)
  );
  Arbiter2_SRAMBundleAW_1 dataWriteArb (	// src/main/scala/nutcore/mem/Cache.scala:255:28
    .io_in_0_valid          (hitWrite),	// src/main/scala/nutcore/mem/Cache.scala:283:22
    .io_in_0_bits_setIdx    (dataHitWriteBus_x3),	// src/main/scala/nutcore/mem/Cache.scala:286:35
    .io_in_0_bits_data_data (dataRead),	// src/main/scala/nutcore/mem/Cache.scala:275:21
    .io_in_0_bits_waymask   (io_in_bits_waymask),
    .io_in_1_valid          (dataRefillWriteBus_x9),	// src/main/scala/nutcore/mem/Cache.scala:404:39
    .io_in_1_bits_setIdx    ({io_in_bits_req_addr[12:6], readBeatCnt_value}),	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:258:31, :404:72
    .io_in_1_bits_data_data (io_mem_resp_bits_rdata),
    .io_in_1_bits_waymask   (io_in_bits_waymask),
    .io_out_valid           (_dataWriteArb_io_out_valid),
    .io_out_bits_setIdx     (_dataWriteArb_io_out_bits_setIdx),
    .io_out_bits_data_data  (_dataWriteArb_io_out_bits_data_data),
    .io_out_bits_waymask    (_dataWriteArb_io_out_bits_waymask)
  );
  LogPerfHelper LogPerfHelper (	// difftest/src/main/scala/common/LogPerfControl.scala:60:79
    .timer     (_LogPerfHelper_timer),
    .logEnable (_LogPerfHelper_logEnable),
    .clean     (/* unused */),
    .dump      (/* unused */)
  );
  assign io_in_ready = io_in_ready_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :458:70
  assign io_out_valid = io_out_valid_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :445:31
  assign io_out_bits_cmd = io_out_bits_cmd_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :440:21
  assign io_out_bits_rdata = io_out_bits_rdata_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :439:29
  assign io_out_bits_user = io_in_bits_req_user;	// src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_isFinish = io_isFinish_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :455:8
  assign io_dataReadBus_req_valid = io_dataReadBus_req_valid_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :306:81
  assign io_dataReadBus_req_bits_setIdx =
    {io_in_bits_req_addr[12:6],
     _io_dataReadRespToL1_T_2 ? readBeatCnt_value : writeBeatCnt_value};	// src/main/scala/chisel3/util/Counter.scala:61:40, src/main/scala/nutcore/mem/Cache.scala:235:14, :258:31, :306:66, :307:{17,33}
  assign io_dataWriteBus_req_valid = _dataWriteArb_io_out_valid;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :255:28
  assign io_dataWriteBus_req_bits_setIdx = _dataWriteArb_io_out_bits_setIdx;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :255:28
  assign io_dataWriteBus_req_bits_data_data = _dataWriteArb_io_out_bits_data_data;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :255:28
  assign io_dataWriteBus_req_bits_waymask = _dataWriteArb_io_out_bits_waymask;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :255:28
  assign io_metaWriteBus_req_valid = _metaWriteArb_io_out_valid;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :254:28
  assign io_metaWriteBus_req_bits_setIdx = _metaWriteArb_io_out_bits_setIdx;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :254:28
  assign io_metaWriteBus_req_bits_data_tag = _metaWriteArb_io_out_bits_data_tag;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :254:28
  assign io_metaWriteBus_req_bits_data_dirty = _metaWriteArb_io_out_bits_data_dirty;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :254:28
  assign io_metaWriteBus_req_bits_waymask = _metaWriteArb_io_out_bits_waymask;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :254:28
  assign io_mem_req_valid = io_mem_req_valid_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :329:48
  assign io_mem_req_bits_addr = io_mem_req_bits_addr_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :324:35
  assign io_mem_req_bits_cmd = io_mem_req_bits_cmd_0;	// src/main/scala/bus/simplebus/SimpleBus.scala:65:14, src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_mem_req_bits_wdata = _dataHitWay_T_10;	// src/main/scala/chisel3/util/Mux.scala:30:73, src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_mmio_req_valid = io_mmio_req_valid_0;	// src/main/scala/nutcore/mem/Cache.scala:235:14, :334:31
  assign io_mmio_req_bits_addr = io_in_bits_req_addr;	// src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_mmio_req_bits_size = io_in_bits_req_size;	// src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_mmio_req_bits_cmd = io_in_bits_req_cmd;	// src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_mmio_req_bits_wmask = io_in_bits_req_wmask;	// src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_mmio_req_bits_wdata = io_in_bits_req_wdata;	// src/main/scala/nutcore/mem/Cache.scala:235:14
  assign io_dataReadRespToL1 =
    hitReadBurst
    & (~(|state) & io_out_ready | _io_dataReadRespToL1_T_2 & _io_dataReadRespToL1_T_3);	// src/main/scala/nutcore/mem/Cache.scala:235:14, :263:26, :294:22, :297:28, :306:66, :329:89, :343:31, :459:{39,60,76,99}
endmodule

